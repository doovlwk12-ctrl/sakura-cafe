"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8831],{8058:function(e,r,a){var s=a(7437),t=a(2265),l=a(3464),o=a(9057);r.Z=()=>{let{t:e,isRTL:r}=(0,o.Z)(),[a,n]=(0,t.useState)([]),[d,i]=(0,t.useState)({username:"",email:"",password:"",role:"cashier"}),[c,u]=(0,t.useState)(null),[m,h]=(0,t.useState)(!1),[x,b]=(0,t.useState)(""),g=localStorage.getItem("admin_token"),p=async()=>{if(!g){b("غير مصرح لك بالوصول");return}h(!0),b("");try{n([{_id:"1",username:"admin",email:"admin@sakura.com",role:"admin"},{_id:"2",username:"cashier1",email:"cashier1@sakura.com",role:"cashier"},{_id:"3",username:"user1",email:"user1@sakura.com",role:"user"}]);try{let e=await l.Z.get("http://localhost:5000/api/users",{headers:{Authorization:"Bearer ".concat(g)},timeout:3e3});n(e.data)}catch(e){console.warn("Backend not available, using mock data")}}catch(e){console.error(e),b("فشل في تحميل البيانات")}finally{h(!1)}};(0,t.useEffect)(()=>{p()},[]);let y=async()=>{if(!d.username||!d.email){b("يرجى ملء جميع الحقول المطلوبة");return}try{let e={_id:Date.now().toString(),username:d.username,email:d.email,role:d.role};n(r=>[...r,e]),i({username:"",email:"",password:"",role:"cashier"});try{await l.Z.post("http://localhost:5000/api/users",d,{headers:{Authorization:"Bearer ".concat(g)},timeout:3e3})}catch(e){console.warn("Backend not available, user added locally only")}}catch(e){console.error(e),b("فشل في إضافة المستخدم")}},j=async()=>{if(!c||!d.username||!d.email){b("يرجى ملء جميع الحقول المطلوبة");return}try{n(e=>e.map(e=>e._id===c._id?{...e,username:d.username,email:d.email,role:d.role}:e)),u(null),i({username:"",email:"",password:"",role:"cashier"});try{await l.Z.put("http://localhost:5000/api/users/".concat(c._id),d,{headers:{Authorization:"Bearer ".concat(g)},timeout:3e3})}catch(e){console.warn("Backend not available, user updated locally only")}}catch(e){console.error(e),b("فشل في تحديث المستخدم")}},N=async e=>{if(confirm("هل أنت متأكد من حذف هذا المستخدم؟"))try{n(r=>r.filter(r=>r._id!==e));try{await l.Z.delete("http://localhost:5000/api/users/".concat(e),{headers:{Authorization:"Bearer ".concat(g)},timeout:3e3})}catch(e){console.warn("Backend not available, user deleted locally only")}}catch(e){console.error(e),b("فشل في حذف المستخدم")}};return(0,s.jsxs)("div",{className:"p-3 md:p-6 bg-white rounded-lg shadow-lg",children:[(0,s.jsx)("h1",{className:"text-xl md:text-2xl font-bold mb-4 md:mb-6 text-deep-50",children:"\uD83D\uDC64 إدارة المستخدمين"}),x&&(0,s.jsx)("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:x}),m&&(0,s.jsx)("div",{className:"mb-4 text-center",children:(0,s.jsxs)("div",{className:"inline-flex items-center gap-2",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-sakura-50"}),(0,s.jsx)("span",{children:"جاري التحميل..."})]})}),(0,s.jsxs)("div",{className:"mb-6 p-4 border border-gray-200 rounded-lg bg-gray-50",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[(0,s.jsx)("input",{className:"border border-gray-300 p-2 rounded focus:outline-none focus:ring-2 focus:ring-sakura-50",type:"text",placeholder:"اسم المستخدم",value:d.username,onChange:e=>i({...d,username:e.target.value})}),(0,s.jsx)("input",{className:"border border-gray-300 p-2 rounded focus:outline-none focus:ring-2 focus:ring-sakura-50",type:"email",placeholder:"البريد الإلكتروني",value:d.email,onChange:e=>i({...d,email:e.target.value})}),(0,s.jsx)("input",{className:"border border-gray-300 p-2 rounded focus:outline-none focus:ring-2 focus:ring-sakura-50",type:"password",placeholder:"كلمة المرور",value:d.password,onChange:e=>i({...d,password:e.target.value})}),(0,s.jsxs)("select",{className:"border border-gray-300 p-2 rounded focus:outline-none focus:ring-2 focus:ring-sakura-50",value:d.role,onChange:e=>i({...d,role:e.target.value}),children:[(0,s.jsx)("option",{value:"admin",children:"مدير"}),(0,s.jsx)("option",{value:"cashier",children:"كاشير"}),(0,s.jsx)("option",{value:"user",children:"مستخدم"})]})]}),c?(0,s.jsx)("button",{onClick:j,className:"btn-secondary",children:"تحديث المستخدم"}):(0,s.jsx)("button",{onClick:y,className:"btn-primary",children:"إضافة مستخدم"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold text-deep-50",children:["قائمة المستخدمين (",a.length,")"]}),(0,s.jsx)("div",{className:"hidden md:block overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"bg-deep-50 text-white",children:[(0,s.jsx)("th",{className:"border border-gray-300 p-3 text-right",children:"اسم المستخدم"}),(0,s.jsx)("th",{className:"border border-gray-300 p-3 text-right",children:"البريد الإلكتروني"}),(0,s.jsx)("th",{className:"border border-gray-300 p-3 text-right",children:"الدور"}),(0,s.jsx)("th",{className:"border border-gray-300 p-3 text-right",children:"الإجراءات"})]})}),(0,s.jsx)("tbody",{children:a.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"border border-gray-300 p-3 text-right",children:e.username}),(0,s.jsx)("td",{className:"border border-gray-300 p-3 text-right",children:e.email}),(0,s.jsx)("td",{className:"border border-gray-300 p-3 text-right",children:(0,s.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat("admin"===e.role?"bg-red-100 text-red-800":"cashier"===e.role?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:"admin"===e.role?"مدير":"cashier"===e.role?"كاشير":"مستخدم"})}),(0,s.jsx)("td",{className:"border border-gray-300 p-3 text-right",children:(0,s.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,s.jsx)("button",{onClick:()=>{u(e),i({username:e.username,email:e.email,password:"",role:e.role})},className:"bg-yellow-500 hover:bg-yellow-600 text-white px-3 py-1 rounded text-sm",children:"تعديل"}),(0,s.jsx)("button",{onClick:()=>N(e._id),className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm",children:"حذف"})]})})]},e._id))})]})}),(0,s.jsx)("div",{className:"md:hidden space-y-3",children:a.map(e=>(0,s.jsxs)("div",{className:"border border-gray-300 rounded-lg p-4 bg-white",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-bold text-gray-800",children:e.username}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:e.email})]}),(0,s.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat("admin"===e.role?"bg-red-100 text-red-800":"cashier"===e.role?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:"admin"===e.role?"مدير":"cashier"===e.role?"كاشير":"مستخدم"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>{u(e),i({username:e.username,email:e.email,password:"",role:e.role})},className:"flex-1 bg-yellow-500 hover:bg-yellow-600 text-white py-2 rounded text-sm",children:"تعديل"}),(0,s.jsx)("button",{onClick:()=>N(e._id),className:"flex-1 bg-red-500 hover:bg-red-600 text-white py-2 rounded text-sm",children:"حذف"})]})]},e._id))}),0===a.length&&!m&&(0,s.jsx)("div",{className:"text-center py-8 text-gray-500",children:"لا توجد مستخدمين"})]})]})}},9376:function(e,r,a){var s=a(5475);a.o(s,"usePathname")&&a.d(r,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(r,{useRouter:function(){return s.useRouter}})}}]);